<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>Markdown editor</title>
		<meta name="description" content="Online javascript markdown editor" />
		<meta name="robots" content="noarchive" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link rel="icon" type="image/png" href="icon.png" />
		<style type="text/css">
body {
	margin: 0;
	padding: 0;
	background: #444;
	color: #ddd;
	font-size: 12px;
	font-family: sans-serif;
}
.col {
	position: fixed;
	top: 8px;
	bottom: 10px;
	border: 1px solid rgba(0,200,255,0.5);
	background: #222;
}
.left.col {
	left: 8px;
	right: 50%;
	right: calc(50% + 8px);
}
.right.col {
	left: 50%;
	left: calc(50% + 8px);
	right: 8px;
}
.controls {
	position: fixed;
	right: 10px;
	top: 10px;
	padding: 8px;
	background: rgba(0, 0, 0, 0.75);
	display: none;
}
.right.col:hover .controls {
	display: block;
}
.source {
	background: inherit;
	color: inherit;
	width: 100%;
	height: 100%;
	height: calc(100% - 1px);
	border: 0 none;
	padding: 4px;
	-moz-box-sizing: border-box;
	-webkit-box-sizing: border-box;
	box-sizing: border-box;
}
#preview {
	padding: 4px;
	overflow: auto;
}
#preview a {
	color: #db2;
	text-decoration: none;
	border-bottom: 1px solid rgba(136, 136, 136, 0.3);
}
#preview a:hover {
	color: #dd2;
}
#preview a:active {
	position: relative;
	outline: none;
	top: 1px;
	color: #dd2;
}
#preview pre {
	white-space: -moz-pre-wrap;
	white-space: -pre-wrap;
	white-space: -o-pre-wrap;
	white-space: pre-wrap;
	word-wrap: break-word;
	background-color: rgba(136, 136, 136, 0.2);
	border-radius: 2px;
	border: 1px solid #000;
	padding: 10px 15px 10px 15px;
	margin: 15px;
}
#preview table {
	border-collapse: collapse;
	border-spacing: 0;
}
#preview td, #preview th {
	vertical-align: top;
	padding: 4px 10px;
	border: 1px solid #bbb;
}
		</style>
		<script type="text/javascript" src="marked.min.js"></script>
	</head>
	<body>
		<div class="left col">
			<textarea id="source" class="source" name="text" rows="10" spellcheck="true" autofocus>Type markdown here</textarea>
		</div>
		<div class="right col">
			<div id="preview"></div>
			<textarea id="htmlPreview" class="source" name="text" rows="10" spellcheck="false" style="display:none"></textarea>
			<div class="controls">
				<input id="chkOutputType" type="checkbox" name="chkOutputType">
				<label for="chkOutputType">Show HTML</label>
				<div></div>
				<input id="chkHtmlWrap" type="checkbox" name="chkHtmlWrap" disabled checked>
				<label for="chkHtmlWrap">Surround HTML body</label>
			</div>
		</div>

		<script type="text/javascript">
if (marked)
{
	var opts = {
		sanitize: true,
		gfm: true,
		pedantic: false,
		tables: true,
		smartLists: true
	};

	var htmlExport = {
		prefix: "<!DOCTYPE html>\n<html>\n\t<head>\n\t\t<meta charset=\"utf-8\">\n\t\t<title>Document</title>\n\t</head>\n\t<body>",
		suffix: "\t</body>\n</html>\n"
	};

	var source = document.getElementById("source"), preview = document.getElementById("preview"), htmlPreview = document.getElementById("htmlPreview"), 
		chkOutputType = document.getElementById("chkOutputType"), chkHtmlWrap = document.getElementById("chkHtmlWrap");

	source.select();

	function getHtml(htmlWrap)
	{
		var html = marked(source.value, opts);

		if (htmlWrap)
			html = htmlExport.prefix + html + htmlExport.suffix;

		return html;
	}

	function update()
	{
		var html = getHtml(chkOutputType.checked && chkHtmlWrap.checked);

		if (chkOutputType.checked)
			htmlPreview.value = html;
		else
			preview.innerHTML = html;
	}

	source.addEventListener("input", update, false);
	source.addEventListener("propertychange", update, false);
	update();

	chkOutputType.addEventListener("change", function() {
		chkHtmlWrap.disabled = !chkOutputType.checked;
		preview.style.display = chkOutputType.checked ? "none" : "";
		htmlPreview.style.display = !chkOutputType.checked ? "none" : "";

		update();
	}, false);
	chkHtmlWrap.addEventListener("change", update, false);
}
		</script>
	</body>
</html>
